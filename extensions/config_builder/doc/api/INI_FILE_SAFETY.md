# INI æ–‡ä»¶æ“ä½œå®‰å…¨æ€§è¯´æ˜

## ğŸ“‹ ç®€çŸ­ç­”æ¡ˆ

**æ‰€æœ‰ä¿®æ”¹éƒ½åœ¨å†…å­˜ä¸­è¿›è¡Œï¼Œä¸ä¼šè‡ªåŠ¨ä¿®æ”¹åŸå§‹ INI æ–‡ä»¶ã€‚**

åŸå§‹æ–‡ä»¶åªæœ‰åœ¨ä½ æ˜¾å¼è°ƒç”¨ `to_ini()` æ—¶æ‰ä¼šè¢«ä¿®æ”¹ã€‚

---

## ğŸ” è¯¦ç»†è¯´æ˜

### ä¸‰ä¸ªå…³é”®æ“ä½œ

#### 1ï¸âƒ£ åŠ è½½æ“ä½œ - `from_ini(filepath)`

```python
builder = AEPsychConfigBuilder.from_ini('config.ini')
```

**åšäº†ä»€ä¹ˆ**ï¼š

- è¯»å– `config.ini` æ–‡ä»¶å†…å®¹
- å°†é…ç½®è§£æåˆ°å†…å­˜ä¸­çš„ `config_dict`
- **ä¸ä¿®æ”¹åŸå§‹æ–‡ä»¶**

**åŸå§‹æ–‡ä»¶çŠ¶æ€**ï¼šâœ… ä¿æŒä¸å˜

#### 2ï¸âƒ£ ä¿®æ”¹æ“ä½œ - `add_parameter()`, `add_strategy()` ç­‰

```python
builder.add_parameter('intensity', 'continuous', lower_bound=0, upper_bound=100)
builder.add_common(['intensity'], 1, ['binary'], ['sobol'])
```

**åšäº†ä»€ä¹ˆ**ï¼š

- ä¿®æ”¹å†…å­˜ä¸­çš„ `config_dict`
- **å®Œå…¨ä¸æ¥è§¦ç¡¬ç›˜ä¸Šçš„æ–‡ä»¶**

**åŸå§‹æ–‡ä»¶çŠ¶æ€**ï¼šâœ… ä¿æŒä¸å˜

#### 3ï¸âƒ£ ä¿å­˜æ“ä½œ - `to_ini(filepath)`

```python
# ä¿å­˜åˆ°æ–°æ–‡ä»¶
builder.to_ini('modified_config.ini')

# æˆ–è¦†ç›–åŸæ–‡ä»¶
builder.to_ini('config.ini')
```

**åšäº†ä»€ä¹ˆ**ï¼š

- å°†å†…å­˜ä¸­çš„ `config_dict` å†™å…¥ INI æ–‡ä»¶
- å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶
- å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œè¦†ç›–å†…å®¹

**åŸå§‹æ–‡ä»¶çŠ¶æ€**ï¼š

- å¦‚æœä½¿ç”¨æ–°è·¯å¾„ï¼šåŸæ–‡ä»¶ âœ… ä¿æŒä¸å˜
- å¦‚æœè¦†ç›–åŸè·¯å¾„ï¼šåŸæ–‡ä»¶ âš ï¸ è¢«ä¿®æ”¹

---

## ğŸ“Š å·¥ä½œæµå›¾ç¤º

```
Step 1: åŠ è½½
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åŸå§‹ config.ini         â”‚
â”‚ [common]                â”‚
â”‚ parnames = ['x']        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ from_ini()
              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ å†…å­˜ config_dict    â”‚
    â”‚ {common: {...}}     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    åŸæ–‡ä»¶ä»ç„¶ä¸å˜ âœ…

Step 2: ä¿®æ”¹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åŸå§‹ config.ini         â”‚
â”‚ [common]                â”‚
â”‚ parnames = ['x']        â”‚  âœ… æœªæ”¹å˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ å†…å­˜ config_dict    â”‚
    â”‚ {common:            â”‚
    â”‚   parnames:         â”‚
    â”‚   ['x','intensity']}â”‚  â† å·²ä¿®æ”¹
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 3: ä¿å­˜ï¼ˆæ–°æ–‡ä»¶ï¼‰
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ å†…å­˜ config_dict         â”‚
    â”‚ {common: {...}}          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ to_ini('new.ini')
                   â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ æ–°æ–‡ä»¶ new.ini           â”‚
    â”‚ [common]                 â”‚
    â”‚ parnames = ['x','intensity'] â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åŸå§‹ config.ini         â”‚
â”‚ [common]                â”‚
â”‚ parnames = ['x']        â”‚  âœ… ä»æœªæ”¹å˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¡ å®é™…ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯ 1: ç¼–è¾‘é…ç½®ä½†ä¿æŒåŸæ–‡ä»¶ä¸å˜

```python
# åŠ è½½
builder = AEPsychConfigBuilder.from_ini('my_config.ini')

# ä¿®æ”¹ï¼ˆåŸæ–‡ä»¶ä¸å˜ï¼‰
builder.add_parameter('new_param', 'continuous', lower_bound=0, upper_bound=1)

# ä¿å­˜åˆ°æ–°æ–‡ä»¶ï¼ˆåŸæ–‡ä»¶ä»ä¸å˜ï¼‰
builder.to_ini('my_config_v2.ini')

# åŸå§‹ my_config.ini ä¿æŒå®Œæ•´ä¸å˜
```

### åœºæ™¯ 2: ç¼–è¾‘åè¦†ç›–åŸæ–‡ä»¶

```python
# åŠ è½½
builder = AEPsychConfigBuilder.from_ini('my_config.ini')

# ä¿®æ”¹ï¼ˆåŸæ–‡ä»¶ä¸å˜ï¼‰
builder.add_parameter('new_param', 'continuous', lower_bound=0, upper_bound=1)

# ä¿å­˜å›åŸæ–‡ä»¶ï¼ˆç°åœ¨æ‰ä¿®æ”¹ï¼‰
builder.to_ini('my_config.ini')

# ç°åœ¨ my_config.ini è¢«æ›´æ–°ä¸ºåŒ…å« new_param çš„ç‰ˆæœ¬
```

### åœºæ™¯ 3: è¯•éªŒæ€§ä¿®æ”¹

```python
# åŠ è½½
builder = AEPsychConfigBuilder.from_ini('my_config.ini')

# ä¿®æ”¹ï¼ˆåŸæ–‡ä»¶ä¸å˜ï¼‰
builder.add_parameter('test_param', 'continuous', lower_bound=0, upper_bound=1)

# å¦‚æœæ»¡æ„å°±ä¿å­˜
if is_satisfied:
    builder.to_ini('my_config_final.ini')
else:
    print("ä¿®æ”¹è¢«æ”¾å¼ƒï¼ŒåŸæ–‡ä»¶å®Œå…¨ä¸å—å½±å“")

# åŸå§‹ my_config.ini æ— è®ºå¦‚ä½•éƒ½ä¿æŒä¸å˜
```

---

## âš ï¸ å¸¸è§é™·é˜±

### âŒ é”™è¯¯è®¤è¯† 1

**"åŠ è½½æ–‡ä»¶åï¼Œä¿®æ”¹ä¼šè‡ªåŠ¨ä¿å­˜åˆ°åŸæ–‡ä»¶"**

ä¸å¯¹ï¼ä¿®æ”¹åªåœ¨å†…å­˜ä¸­ï¼Œä¸ä¼šè‡ªåŠ¨ä¿å­˜ã€‚

```python
builder = AEPsychConfigBuilder.from_ini('config.ini')
builder.add_parameter(...)
# âŒ config.ini æ²¡æœ‰è¢«ä¿®æ”¹ï¼
```

### âŒ é”™è¯¯è®¤è¯† 2

**"å¿…é¡»ä¸€ç›´æŒæœ‰åŸæ–‡ä»¶å¼•ç”¨"**

ä¸éœ€è¦ï¼åŠ è½½åå†…å­˜ä¸­å·²æœ‰å®Œæ•´é…ç½®ï¼Œæ–‡ä»¶å¯ä»¥è¢«åˆ é™¤ã€‚

```python
builder = AEPsychConfigBuilder.from_ini('config.ini')
os.remove('config.ini')  # å¯ä»¥åˆ é™¤ï¼
builder.add_parameter(...)
builder.to_ini('new_config.ini')  # ä»ç„¶å¯ä»¥å·¥ä½œ
```

### âœ… æ­£ç¡®åšæ³•

```python
# 1. åŠ è½½
builder = AEPsychConfigBuilder.from_ini('config.ini')

# 2. ä¿®æ”¹ï¼ˆå®‰å…¨ï¼ŒåŸæ–‡ä»¶ä¸å˜ï¼‰
builder.add_parameter(...)

# 3. æ˜¾å¼ä¿å­˜ï¼ˆå¿…é¡»ï¼‰
builder.to_ini('modified.ini')  # æ–°æ–‡ä»¶
# æˆ–
builder.to_ini('config.ini')  # è¦†ç›–åŸæ–‡ä»¶
```

---

## ğŸ” æ–‡ä»¶æ“ä½œå®‰å…¨æ€§æ€»ç»“

| æ“ä½œ | ä¿®æ”¹åŸæ–‡ä»¶? | è¯´æ˜ |
|------|-----------|------|
| `from_ini(file)` | âŒ å¦ | åªè¯»å–ï¼Œä¸ä¿®æ”¹ |
| `add_parameter()` | âŒ å¦ | å†…å­˜ä¿®æ”¹ï¼Œä¸æ¶‰åŠæ–‡ä»¶ |
| `add_strategy()` | âŒ å¦ | å†…å­˜ä¿®æ”¹ï¼Œä¸æ¶‰åŠæ–‡ä»¶ |
| `add_common()` | âŒ å¦ | å†…å­˜ä¿®æ”¹ï¼Œä¸æ¶‰åŠæ–‡ä»¶ |
| `to_ini(new_path)` | âŒ å¦ | åˆ›å»ºæ–°æ–‡ä»¶ï¼ŒåŸæ–‡ä»¶ä¸å˜ |
| `to_ini(original_path)` | âš ï¸ æ˜¯ | è¦†ç›–åŸæ–‡ä»¶ |

---

## ğŸ“ æ•°æ®æµå›¾

```
INI æ–‡ä»¶
  â†“ from_ini()
å†…å­˜ config_dict
  â†“ add_* æ–¹æ³•
å†…å­˜ config_dict (ä¿®æ”¹)
  â†“ to_ini()
æ–° INI æ–‡ä»¶ / åŸ INI æ–‡ä»¶

å…³é”®ç‚¹ï¼š
- åŸ INI æ–‡ä»¶åªåœ¨ to_ini() æ—¶è¢«è§¦åŠ
- å¦‚æœä¸è°ƒç”¨ to_ini()ï¼ŒåŸæ–‡ä»¶æ°¸ä¸æ”¹å˜
- å³ä½¿è°ƒç”¨ to_ini()ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä¿å­˜ä½ç½®
```

---

## ğŸ¯ æœ€ä½³å®è·µ

### 1. ä¿æŒåŸæ–‡ä»¶å®‰å…¨

```python
# æ€»æ˜¯ä¿å­˜åˆ°æ–°æ–‡ä»¶
builder.to_ini('config_modified.ini')
```

### 2. ä¿ç•™å¤‡ä»½

```python
import shutil

# å¤‡ä»½åŸæ–‡ä»¶
shutil.copy('config.ini', 'config.ini.backup')

# ä¿®æ”¹å¹¶ä¿å­˜
builder = AEPsychConfigBuilder.from_ini('config.ini')
builder.add_parameter(...)
builder.to_ini('config.ini')
```

### 3. ç‰ˆæœ¬ç®¡ç†

```python
from datetime import datetime

# ä¿å­˜ä¸åŒç‰ˆæœ¬
timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
builder.to_ini(f'config_{timestamp}.ini')
```

---

## æ€»ç»“

âœ… **å®‰å…¨æ€§**ï¼šä¿®æ”¹å‰å¿…é¡»ä¿å­˜ï¼Œå¦åˆ™åŸæ–‡ä»¶æ°¸ä¸æ”¹å˜  
âœ… **çµæ´»æ€§**ï¼šå¯ä»¥é€‰æ‹©ä¿å­˜ä½ç½®ï¼ˆæ–°æ–‡ä»¶æˆ–è¦†ç›–åŸæ–‡ä»¶ï¼‰  
âœ… **å¯æ§æ€§**ï¼šç”¨æˆ·å®Œå…¨æ§åˆ¶ä½•æ—¶ä¿å­˜å’Œä¿å­˜åˆ°å“ªé‡Œ  
âœ… **å¯é€†æ€§**ï¼šæ‰€æœ‰ä¿®æ”¹éƒ½å¯ä»¥æ”¾å¼ƒï¼ˆä¸è°ƒç”¨ to_iniï¼‰
