# PoolBasedGenerator Configuration
# 基于池的生成器（采集函数 + 跨运行去重）
#
# 功能：从预定义候选点池中用采集函数智能选择最信息丰富的点
# 特点：
#   - 池基础主动学习（候选点集合固定）
#   - 采集函数评估所有点，选择采集值最高的点
#   - 【新增】跨运行去重，支持被试隔离，完全符合 AEPsych 标准
#
# 使用场景：
# - 设计空间固定，从中选择最优实验点
# - 多轮实验需要防止重复采样
# - 多被试实验需要数据完全隔离
# - 结合模型的不确定性进行主动学习

[PoolBasedGenerator]
# 候选点池的张量表示
# 类型: 文件路径或直接张量 (必需)
# 说明: 包含所有候选点的数据
# 格式: 支持CSV或torch tensor格式
# 维度: [n_points, dim] - n_points个候选点，dim维参数空间
pool_points = path/to/candidate_pool.pt

# 采集函数类型
# 类型: str (必需)
# 说明: 用于评估候选点的采集函数
# 选项:
#   - ExpectedImprovement - 期望改进
#   - UpperConfidenceBound - 上置信界
#   - qExpectedImprovement - 批量期望改进
#   - ProbabilityOfImprovement - 改进概率
# 默认: qExpectedImprovement
acqf = qExpectedImprovement

# 采集函数的额外参数
# 类型: dict (可选)
# 说明: 传递给采集函数的其他参数
# 格式: Python字典格式，例如 {'beta': 0.2, 'maximize': True}
# 范围: 取决于所选采集函数
acqf_kwargs = {}

# 是否允许重复采样
# 类型: bool (可选)
# 默认值: False
# 选项: True 或 False
# 说明: 是否允许重复选择已使用过的点
#   - False: 选中的点不再出现在池中（推荐）
#   - True: 点可以被重复选择
allow_resampling = False

# 是否打乱候选池
# 类型: bool (可选)
# 默认值: True
# 选项: True 或 False
# 说明: 初始化时是否随机打乱候选点顺序
#   - True: 打乱顺序，增加随机性
#   - False: 保持原始顺序
shuffle = True

# 随机种子
# 类型: int (可选)
# 默认值: None
# 说明: 用于重现性控制
#   - None: 不固定随机性
#   - 整数值: 固定的随机种子，确保可重现
seed = None

# 去重数据库路径
# 类型: str (可选)
# 默认值: None
# 说明: 指向被试专用的去重数据库路径，用于跨运行的采样点持久化
#   - None: 不指定，使用临时内存数据库（仅限当前运行）
#   - 文件路径: 使用 SQLite 数据库，数据跨运行持久化
# 示例: ./data/subject_A/dedup.db
# 特性:
#   - 被试隔离: 每个被试使用独立数据库，互不影响
#   - 增量累积: 每次实验数据追加到数据库
#   - 多阶段支持: 所有生成器阶段（Manual、PoolBased等）的点都被记录
#   - 标准兼容: 使用 AEPsych 标准 param_data 表结构
# 多被试配置示例:
#   Subject A: dedup_database_path = ./data/subject_A/dedup.db
#   Subject B: dedup_database_path = ./data/subject_B/dedup.db
#   Subject C: dedup_database_path = ./data/subject_C/dedup.db
dedup_database_path = None

# 注意事项：
# 1. pool_points 必须提供，维度应与实验设计空间匹配
# 2. 模型必须存在，采集函数才能正常工作
# 3. acqf_kwargs 中的参数应与选定的采集函数兼容
# 4. allow_resampling=False时，点数应足够应对所有实验轮次
# 5. dedup_database_path 推荐用于多轮实验和多被试场景
#
# 最佳实践：
# • 指定 dedup_database_path（生产环境）
# • 使用被试特定目录：./data/subject_<ID>/
# • 定期备份数据库文件
# • 不要在多进程中共享同一生成器实例
